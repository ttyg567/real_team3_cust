<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.kbstar.mapper.MyScheduleMapper">

    <insert id="insert" parameterType="mySchedule">
    INSERT INTO myschedule (MYSCHEDULENO, CLASSNO, PURCHASENO, SCHEDULECOMPLETED, SHEDULECANCELED, CUSTNO)
    VALUES (myschedule_seq.NextVAL, #{classNo}, #{purchaseNo}, '0', '0', #{custNo})
    </insert>

    <!-- 특정일자 예약한 수업 조회 (운동 취소여부 : '0', 대표계정 : '1') -->
    <select id="isReserved_day" parameterType="mySchedule" resultType="mySchedule">
        select m.*, c.className, c.classDate, c.classStarttime, c.classEndtime, c.sportsType, c.sportsClasstype
             , g.gymName, t.trainerName
        from myschedule m
                 left join class c on m.classNo =  c.classNo
                 left join gym g on c.gymNo = g.gymNo
                 left join trainer t on c.trainerNo = t.trainerNo
        where m.custno = #{custNo} and SHEDULECANCELED ='0' and g.gymMasterCk = '1' and c.classDate=#{classDate}
    </select>

    <!-- 예약한 수업 조회 (운동 취소여부 : '0', 대표계정 : '1') -->
    <select id="isReserved" parameterType="Integer" resultType="mySchedule">
        select m.*, c.className, c.classDate, c.classStarttime, c.classEndtime, c.sportsType, c.sportsClasstype
        , g.gymName, t.trainerName
        from myschedule m
            left join class c on m.classNo =  c.classNo
            left join gym g on c.gymNo = g.gymNo
            left join trainer t on c.trainerNo = t.trainerNo
        where m.custno = #{custNo} and SHEDULECANCELED ='0' and g.gymMasterCk = '1'
    </select>

    <!-- 운동완료 리스트 추출-->
    <select id="isCompleted" parameterType="mySchedule" resultType="mySchedule">
        select m.*, c.classDate
        from myschedule m left join class c on m.classNo =  c.classNo
        where m.custno = #{custNo} and m.SCHEDULECOMPLETED = '1'
    </select>


</mapper>